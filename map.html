<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Guides</title>
<meta name="viewport" content="initial-scale=1, minimum-scale=1, maximum-scale=10, user-scalable=0">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<div id="map"></div>
<script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoic3VtLW1pc2hyYSIsImEiOiJjbHVvbWl2MGYxejI4MmtsbWZyZHNxd2w1In0.fijovQLTzPBTi-BCWItQkw';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [0, 0], // Default center coordinates
      zoom: 11 // Default zoom level
    });

    var mumbai = {
      1: { coordinates: [72.932498, 19.119345], price: 60000},
      2: { coordinates: [72.933547, 19.131552], price: 100000 }
    };
    
    var pune = {
      1: { coordinates: [73.868457, 18.545757], price: 10000 },
      2: { coordinates: [73.837214, 18.501158], price: 20000 }
    };


    // Function to extract query parameter from URL
    function getQueryVariable(variable) {
      const query = window.location.search.substring(1);
      const vars = query.split('&');
      for (let i = 0; i < vars.length; i++) {
        const pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) === variable) {
          return decodeURIComponent(pair[1]);
        }
      }
      return null;
    }

    document.addEventListener('DOMContentLoaded', function () {
      const query = getQueryVariable('query');
      if (query) {
        if (query.toLowerCase() === 'mumbai') {
          plotCoordinates(mumbai);
          flyToCity(mumbai[1].coordinates);
        } else if (query.toLowerCase() === 'pune') {
          plotCoordinates(pune);
          flyToCity(pune[1].coordinates);
        }
      }
    });

    function plotCoordinates(coordinatesObj) {
      Object.values(coordinatesObj).forEach((coord) => {
        var marker = new mapboxgl.Marker({ color: 'red' })
          .setLngLat(coord.coordinates)
          .addTo(map);

        var popup = new mapboxgl.Popup({ offset: 25 })
          .setHTML('<h3>Price:</h3><p>' + coord.price + '</p>');

        marker.setPopup(popup);
      });
    }

    function flyToCity(coordinates) {
      map.flyTo({
        center: coordinates,
        zoom: 12
      });
    }
  </script>
</body>
</html>
